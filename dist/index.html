<!DOCTYPE html> <html class=no-js> <head> <meta charset=utf-8> <meta name=ROBOTS content="NOINDEX, NOFOLLOW"> <title>SACO: Inkomstjämföraren</title> <meta name=description content=""> <meta name=viewport content="width=device-width"> <link rel="shortcut icon" href=/6df2b309.favicon.ico> <!-- Place favicon.ico and apple-touch-icon.png in the root directory --> <link rel=stylesheet href=styles/c3501083.main.css>  <body> <!--[if lt IE 10]>
      <p class="browsehappy">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]--> <div id=ui> Jag har en månadslön på <input size=5 id=income placeholder="T.ex. 30 000"> kronor och jobbar som <select id=profession> <option value="">Välj yrke </select> inom <select id=publicprivate> <option value=public>offentlig sektor <option value=private>privat sektor </select> . Hur står sig min lön? </div> <div id=chart> </div> <!-- Saco typography --> <script type=text/javascript src=//use.typekit.net/zxg8sjd.js></script> <script type=text/javascript>try { Typekit.load(); } catch (e) { console.log(e); }</script> <script src=scripts/cd5a2582.vendor.js></script> <script src=scripts/3dd412cd.main.js></script> <script>function columnFormats(d) {
      d.value = +d.value.replace(",",".");
      return d;
    }
    function getZeroData(data) {
      var incomeGroups = d3.set(data.map(function(d) { return d.income; }))
        .values()
        .sort();

      return incomeGroups.map(function(d) {
        return {
          income: d,
          incomeLower: +d.split("-")[0],
          incomeUpper: +d.split("-")[1],
          value: 0,
          publicprivate: null,
          profession: null,
        }
      })
    }
    function getCurrentData(data) {
      var profession = elemProfession.node().value;
      var publicprivate = elemPublicPrivate.node().value;

      if (profession == null) {
        return getZeroData(data);
      }
      return data.filter(function(d) {
        return (d.profession == profession && d.publicprivate == publicprivate);
      })
    }
    function validProfessionSelection() {
      return elemProfession.node().value !== "";
    }
    function validIncomeInput() {
      var income = elemIncome.node().value.trim();
      console.log(income, !isNaN(income));
      return !isNaN(income);
    }
    var chartSelector = "#chart";
    var elemProfession = d3.select("#profession");
    var elemIncome = d3.select("#income");
    var elemPublicPrivate = d3.select("#publicprivate");
    var elemChart = d3.select(chartSelector);

    d3.csv("data/data.csv", columnFormats, function(error, data) {
      if (error) throw error;

      // Fetch upper and lower boundry of income group
      data = data.map(function(d) {
        d.incomeLower = +d.income.split("-")[0];
        d.incomeUpper = +d.income.split("-")[1];
        return d;
      })
      
      // Build UI
      var professions = d3.set(data.map(function(d) { return d.profession; }))
        .values()
        .sort();

      elemProfession.selectAll("option")
        .data(professions, function(d) { return d; })
        .enter()
        .append("option")
        .attr("value", function(d) { return d; })
        .text(function(d) { return d.toLowerCase(); });

      // Init visualiztion
      var currentData = getZeroData(data);
      var currentIncome = +elemIncome.node().value;
      var opts = {
        yMax: d3.max(data.map(function(d) { return d.value }))
      };
      var chart = new IncomeChart(chartSelector, currentData, currentIncome, opts)
      
      elemChart.classed("invalid-profession", !validProfessionSelection());
      elemChart.classed("invalid-income", !validIncomeInput());


      // Update chart when UI changes
      d3.selectAll("#publicprivate, #profession").on("change", function() {
        var validProfession = validProfessionSelection();
        elemChart.classed("invalid-profession", !validProfession);
        if (validProfession) {
          var currentData = getCurrentData(data);
          chart.updateData(currentData);          
        }
      })

      elemIncome.on("keyup", function() {
        var validIncome = validIncomeInput();
        elemChart.classed("invalid-income", !validIncome);

        if (validIncome) {
          var currentIncome = +elemIncome.node().value;
          chart.updateIncomeLine(currentIncome);          
        }
      })

      elemIncome.node().value = "32000";
      elemProfession.node().value = "Bibliotekarie";
      d3.selectAll("#publicprivate, #profession").on("change")();
      elemIncome.on("keyup")();
    })</script>  